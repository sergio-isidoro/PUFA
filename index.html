<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>PUFA - Pulseira de Frequencia Cardiaca e Acelerometro</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice 4.1.0  (Win32)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Lino Figueiredo">
	<META NAME="CHANGED" CONTENT="20140530;20525176">
	<META NAME="CHANGEDBY" CONTENT="Lino Figueiredo">
	<META NAME="CHANGEDBY" CONTENT="Jose Puga">
	<META NAME="CHANGEDBY" CONTENT="Jose Puga">
	<META NAME="CHANGEDBY" CONTENT="Jose Puga">
	<META NAME="CHANGEDBY" CONTENT="Jose Puga">
	<META NAME="CHANGEDBY" CONTENT="Jose Puga">
	<META NAME="CHANGEDBY" CONTENT="Jose Puga">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 2.01cm }
		TD P { margin-bottom: 0cm }
		P { margin-bottom: 0.2cm }
		A:link { so-language: zxx }

    body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
    }

    h1, h2 {
        text-align: justify;
    }

    img {
        max-width: 300px; /* Define a largura máxima */
        max-height: 200px; /* Define a altura máxima */
        margin: 10px auto; /* Espaço e centralização */
        display: block;
    }

	.image-big {
        max-width: 3000px; /* Define a largura máxima */
        max-height: 2000px; /* Define a altura máxima */
        margin: 10px auto; /* Espaço e centralização */
        display: block;
    }

    .image-row {
        display: flex;
        justify-content: center;
        gap: 20px; /* Espaço entre as imagens */
        flex-wrap: wrap; /* Permite que as imagens se ajustem em telas menores */
    }

    .image-row .img1 {
        max-width: 300px; /* Mantém o mesmo tamanho */
        max-height: 200px;
    }

	.image-row .img2 {
        max-width: 4000px; /* Mantém o mesmo tamanho */
        max-height: 2900px;
    }
	.image-row .img3 {
        max-width: 1000px; /* Mantém o mesmo tamanho */
        max-height: 700px;
    }
	.formula {
        font-size: 18px;
        line-height: 1.6;
    }
	
	.image-container {
    display: flex;
    justify-content: center; /* Alinha as imagens ao centro */
    align-items: center;     /* Alinha as imagens verticalmente no centro */
    gap: 20px;               /* Espaço entre as imagens */
}

.img1 {
    max-width: 45%;  /* Ajusta a largura das imagens para que fiquem lado a lado */
    height: auto;    /* Mantém a proporção da imagem */
}

	</style>
</HEAD>
<BODY LANG="pt-BR" DIR="LTR">


	
<TABLE WIDTH=100% BORDER=0 CELLPADDING=0 CELLSPACING=0 STYLE="page-break-before: always">
	<COL WIDTH=15*>
	<COL WIDTH=7*>
	<COL WIDTH=18*>
	<COL WIDTH=38*>
	<COL WIDTH=37*>
	<COL WIDTH=13*>
	<COL WIDTH=25*>
	<COL WIDTH=38*>
	<COL WIDTH=23*>
	<COL WIDTH=9*>
	<COL WIDTH=19*>
	<COL WIDTH=15*>
	<TR VALIGN=TOP>
		<TD COLSPAN=2 WIDTH=9% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
		<TD COLSPAN=7 WIDTH=75% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.08cm; padding-left: 0cm; padding-right: 0cm; text-decoration: none"><A NAME="In&iacute;cio"></A>
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=6><I><B>PUFA - Pulseira de Frequencia cardiaca e Acelerómetro</B></I></FONT></FONT></FONT></P>
		</TD>
		<TD ROWSPAN=4 COLSPAN=3 WIDTH=17% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm">
			<BR><BR>
			</P>
			<P ALIGN=CENTER STYLE="margin-bottom: 0.51cm; background: transparent; border: none; padding: 0cm; text-decoration: none">
			<IMG SRC="image002.jpg" NAME="graphics1" ALIGN=RIGHT WIDTH=231 HEIGHT=110 BORDER=0><BR CLEAR=RIGHT><FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=4 STYLE="font-size: 16pt"><I><B>LABSIS</B></I></FONT></FONT></FONT></P>
			<P ALIGN=CENTER STYLE="margin-bottom: 0.51cm; background: transparent; border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B>2024</B></I></FONT></FONT></FONT></P>
			<P ALIGN=CENTER><BR>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=9 WIDTH=83% HEIGHT=34 BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=4><I><B>Autores:</B></I></FONT></FONT></FONT></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=6% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
		<TD COLSPAN=5 WIDTH=44% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#000000"><FONT FACE="Thorndale, serif"><FONT SIZE=1 STYLE="font-size: 8pt"><I><B><FONT COLOR="#ffffff"><FONT SIZE=3>Sérgio Isidoro</FONT></FONT> </B></I></FONT></FONT></FONT>
			</P>
		</TD>
		<TD COLSPAN=3 WIDTH=33% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B>1221709@isep.ipp.pt</B></I></FONT></FONT></FONT></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=6% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
		<TD COLSPAN=5 WIDTH=44% BGCOLOR="#00d9ff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=LEFT STYLE="border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#000000"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B><FONT COLOR="#ffffff">André Nogueira</FONT> </B></I></FONT></FONT></FONT>
			</P>
		</TD>
		<TD COLSPAN=3 WIDTH=33% BGCOLOR="#00d9ff">
			<P ALIGN=LEFT STYLE="margin-bottom: 0.51cm; border: none; padding: 0cm; text-decoration: none">
			<FONT COLOR="#ffffff"><FONT FACE="Thorndale, serif"><FONT SIZE=3><I><B>1212048@isep.ipp.pt</B></I></FONT></FONT></FONT></P>
			<P ALIGN=LEFT><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=3 WIDTH=16% HEIGHT=12 BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Introdu&ccedil;&atilde;o"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN LANG="pt-BR"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Introdu&ccedil;&atilde;o</SPAN></SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD WIDTH=15% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Arquitetura"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Arquitetura</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD WIDTH=14% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Hardware"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Hardware</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD COLSPAN=2 WIDTH=15% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Software"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Software</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD WIDTH=15% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Resultados"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Resultados</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD COLSPAN=2 WIDTH=12% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Conclus&otilde;es"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Conclus&otilde;es</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
		<TD COLSPAN=2 WIDTH=13% BGCOLOR="#ffffff" SDVAL="0" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="border: none; padding: 0cm"><A HREF="#Refer&ecirc;ncias"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Refer&ecirc;ncias</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% BGCOLOR="#ffffff" SDNUM="2070;1046;@">
			<P ALIGN=CENTER STYLE="background: #00d9ff"><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% BGCOLOR="#eeeeee">
			<P ALIGN=CENTER STYLE="margin-bottom: 0.5cm; background: #eeeeee"><BR><BR>
			</P>
			<P ALIGN=CENTER><b>VIDEO Projeto</b></P>
			<P ALIGN=CENTER STYLE="background: #eeeeee"><A HREF="https://github.com/user-attachments/assets/bb75e299-b183-4e6a-995e-6fe85692a9c1">
				<P class="image-row">
					<img src="Projeto_completo_IMG-video.png"  href="https://github.com/user-attachments/assets/bb75e299-b183-4e6a-995e-6fe85692a9c1" BORDER=0 alt="video" class="img3">
				</P>
				</A>
			</P>
				</A>
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff; border: none; padding: 0cm"><A NAME="Introdu&ccedil;&atilde;o"></A>
			<SDFIELD TYPE=DOCINFO SUBTYPE=TITLE></SDFIELD><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal">Introdu&ccedil;&atilde;o</SPAN></FONT></FONT></P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% align="justify" BGCOLOR="#eeeeee">
			<br>
			<p>Nos últimos anos, os avanços tecnológicos têm promovido o desenvolvimento de dispositivos eletrónicos inovadores, capazes de integrar funcionalidades avançadas em estruturas compactas e acessíveis. Esses dispositivos, frequentemente denominados de wearables, combinam monitorização de saúde, segurança e conectividade, desempenhando um papel cada vez mais relevante na melhoria da qualidade de vida.</p>

<p>Entre as inovações destacam-se os sistemas portáteis inteligentes, como os relógios e dispositivos de monitorização biométrica, que permitem acompanhar sinais vitais e detetar condições potencialmente perigosas, como quedas ou alterações na frequência cardíaca. Estes sistemas são especialmente úteis para idosos ou pessoas com limitações físicas, oferecendo não apenas maior autonomia, mas também funcionalidades essenciais de segurança e saúde.</p>

<p>O presente projeto insere-se nesse contexto, propondo o desenvolvimento de um dispositivo leve, portátil e acessível com capacidades de monitorização de frequência cardíaca, deteção de quedas e comunicação remota via Wi-Fi. Para isso, recorreu-se a uma combinação estratégica de hardware e software, incluindo sensores biométricos, um acelerómetro, um microcontrolador versátil e um módulo de comunicação sem fios. Os dados recolhidos são apresentados num display OLED em tempo real e podem ser enviados para uma plataforma online, permitindo uma monitorização remota, eficiente e contínua.</p>

<p>Este relatório explora as bases técnicas do projeto, descrevendo os componentes utilizados, os métodos de comunicação implementados, a estrutura modular do software, os resultados obtidos e o circuito das funcionalidades. O objetivo é fornecer uma visão detalhada do funcionamento do dispositivo, destacando os desafios e soluções encontrados durante o seu desenvolvimento, assim como os benefícios que este sistema pode oferecer no contexto da saúde e segurança pessoal.</p>

<p>Para garantir a integração eficiente de todos os módulos, adotaram-se práticas de otimização, incluindo a utilização de protocolos I2C, UART e ADC, além da implementação de filtros digitais para melhorar a precisão das medições. O resultado é um protótipo funcional que demonstra o potencial deste tipo de tecnologia na criação de soluções práticas, confiáveis e inovadoras.</p>

			<h2>Materiais e ferramentas</h2>
			<h4>Componentes utilizados:</h4>
			<ul>
				<li>Microcontrolador ATmega328P (8 MHz)</li>
				<li>Sensor de frequência cardíaca SEN0203 (ADC)</li>
				<li>OLED 128x64 (I2C)</li>
				<li>Módulo Wi-Fi ESP01 Firmware AT V2.2.2.0 (UART)</li>
				<li>Sensor Acelerómetro MPU6050 (I2C)</li>
				<li>Bateria para alimentação do sistema 3.7V 400mA</li>
				<li>LED vermelho que pisca a 1 Hz (PWM)</li>
				<li>LED verde que pisca a cada batida cardíaca (GPIO)</li>
				<li>Buzzer para alertas (PWM)</li>
				<li>Filtro RC no ADC do sensor SEN0203</li>
				<li>Divisor de tensão para nível da bateria (ADC)</li>
			</ul>
			<h4>Funcionalidades Implementadas:</h4>
			<ul>
				<li>Monitorização de BPM com filtro RC para estabilização do sinal</li>
				<li>Comunicação com o OLED para exibição de dados </li>
				<li>Envio de dados (Wi-Fi / UART)</li>
				<li>Alarmes visuais e sonoros para eventos críticos</li>
			</ul>
			
			<h2>Estado da Arte</h2>
			<p>
				Para guiar o desenvolvimento do projeto, foi realizada uma pesquisa que selecionou equipamentos específicos no mercado. Foram analisadas duas pulseiras, Coospo HW9 e Cycplus H1, além da cinta peitoral Mindfield eSense pulse. A comparação considerou critérios como preço, qualidade de construção, duração e tipo de carregamento da bateria, tipo de sensor, conectividade e funcionalidades oferecidas.
			</p>
			<p>
				A pulseira de frequência cardíaca ótica oferece medição precisa de batimentos por minuto (erro de ±1 BPM) e cálculo de calorias, com bracelete ajustável e LED de 5 cores para otimizar treinos. Possui conectividade Bluetooth 5.0 e ANT+ para integração com dispositivos como SmartWatches. Inclui alerta vibratório para segurança ao ultrapassar a frequência máxima, que pode ser personalizada até 200 BPM. A bateria recarregável com carregamento magnético dura até 35 horas.[1]
			</p>
			<P class="image-row">
				<img src="coospo.png" alt="coospo" class="img1">
			</P>
			<p>
				A pulseira Cycplus é uma solução confortável e prática para monitorar a frequência cardíaca, oferecendo liberdade de movimento e fácil utilização. Com sensor ótico, fornece medições precisas em tempo real, com erro de apenas ±1 BPM. Utiliza LEDs para indicar zonas de frequência cardíaca e é compatível com Bluetooth 5.1 e ANT+, conectando-se a smartphones e smartwatches. Seu carregamento magnético é rápido, completando a carga em 30 minutos, com autonomia superior a 110 horas, ideal para treinos longos.[2]
			</p>
			<P class="image-row">
				<img src="cyplus.png" alt="cyplus" class="img1">
			</P>
			<p>
				O dispositivo combina um ECG de 1 canal (500 Hz) e sensor ótico (erro de ±2 BPM), com faixa peitoral lavável e confortável. Suporta múltiplos utilizadores, oferece estatísticas detalhadas de frequência cardíaca e variabilidade, e inclui feedback variado. A app permite treinos de respiração, biofeedback e exportação de dados. Com bateria de 1 ano de autonomia, é prático e fornece informações sobre estresse, respiração superficial e falta de energia, acessíveis via telemóvel ou tablet.[3]
			</p>
			<P class="image-row">
				<img src="esense.png" alt="esense" class="img1">
			</P>			

			<br>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff; border: none; padding: 0cm"><A NAME="Arquitetura"></A>
			<FONT SIZE=4>Arquitetura</FONT></P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% align="justify" VALIGN=middle BGCOLOR="#eeeeee">
			<br>
			<P class="image-row">
				<img src="Arquitectura.png" alt="arquitectura" class="img2">
			</P>

			<h1>I2C</h1>
			<p>
				A comunicação I2C (two wires comunication) é um protocolo de comunicação serial síncrono que utiliza dois fios (SCL e SDA) para a troca de dados entre dispositivos. No projeto, o ATmega328P utiliza este protocolo para comunicar com o acelerómetro MPU6050 e o display OLED. A comunicação I2C baseia-se na variação de tensões nas linhas de dados (HIGH e LOW) controladas por resistências pull-up. A sincronização entre o MASTER (ATmega328P) e os SLAVE (os dispositivos conectados) é essencial para garantir a transferência de dados correta.
			</p>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=173" target="_blank">Link pag datasheet</a>
			</p>
			<ul>
				<li><strong>OLED 128x64:</strong> Mostra informações como a frequência cardíaca (BPM), estado do sistema e alertas</li>
				<li><strong>MPU6050:</strong> Permite monitorizar movimentos e detectar quedas através da análise dos dados transmitidos ao microcontrolador</li>
			</ul>

			<h1>UART</h1>
			<p>
				O UART (Universal Asynchronous Receiver Transmitter) é um protocolo de comunicação serial assíncrono usado para enviar e receber dados entre dispositivos. No projeto, é utilizado para a comunicação entre o ATmega328P e o módulo ESP01. Na comunicação UART, os bits são transmitidos em série,um de cada vez, ao longo de uma linha de dados (TX e RX). Os níveis de tensão definem os estados lógicos, por exemplo, 0V (LOW) e 3.3V (HIGH) no ESP01.
			</p>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=143" target="_blank">Link pag datasheet</a>
			</p>
			<ul>
				<li><strong>ESP01:</strong> Permite enviar dados de BPM (Batimentos por minuto) até ao dispositivo</li>
				<li><strong>Debug:</strong> Usado para enviar informações do ATmega328P para um terminal serial durante o desenvolvimento</li>
			</ul>

			<h1>ADC</h1>
			<p>
				O ADC (Conversor Analógico para Digital) converte sinais analógicos, como o do sensor de frequência cardíaca SEN0203, em valores digitais processados pelo ATmega328P. O ADC funciona através da amostragem de sinais analógicos a uma frequência específica, mapeando a tensão medida para valores digitais (normalmente de 0 a 1023 num ADC de 10 bits).
			</p>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=205" target="_blank">Link pag datasheet</a>
			</p>
			<ul>
				<li><strong>SEN0203:</strong> O sinal analógico é estabilizado através de um filtro RC antes de ser convertido para digital e usado no cálculo da frequência cardíaca (BPM)</li>
				<li><strong>Nível da bateria:</strong> Com um divisor de tensão é possível monitorizar, permitindo a visualização no sistema.</li>
			</ul>

			<h1>Wi-Fi</h1>
			<p>
				A ligação Wi-Fi é efetuada pelo módulo ESP01 com Firmware AT, que envia os dados recolhidos para a plataforma ThingSpeak. O módulo ESP01 utiliza ondas eletromagnéticas na frequência de 2.4GHz para transmitir dados. Atua como um transcetor, convertendo os dados recebidos via UART em pacotes TCP/IP e enviando-os através da rede.
			</p>
			<p>
				O módulo ESP01 utiliza ondas eletromagnéticas na frequência de 2.4GHz para transmitir dados. Atua como um transceptor, convertendo os dados recebidos via UART em pacotes TCP/IP e enviando-os através da rede.
			</p>
			<p>
				<a href="esp01_AT_instruction.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>
			<ul>
				<li><strong>ESP01:</strong> Permite enviar dados de BPM para o ThingSpeak, facilitando a monitorização remota</li>
				<li><strong>ThingSpeak:</strong> Armazena e apresenta graficamente os dados recolhidos de BPM, permitindo o acesso remoto</li>
			</ul>

			<h1>Timer0</h1>
			<p>O Timer0 é um temporizador de 8 bits que pode ser usado tanto no modo de contagem quanto no modo de geração de interrupções periódicas, que utiliza um oscilador interno ou uma frequência externa como fonte de clock. Neste caso, o ATmega328P está a funcionar a 8MHz internos e recorrendo a um prescaler, reduzimos a frequência de clock para adequar os tempos de contagem correspondentes a 1ms.</p>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=74" target="_blank">Link pag datasheet</a>
			</p>

			<h3>Leitura do ADC:</h3>
			<p>Com o Timer0 configurado para gerar interrupções a cada 1ms, podemos utilizar essas interrupções para realizar leituras periódicas do ADC.</p>
			<p>A cada 1ms surge uma interrupção na qual:</p>
			<ul>
				<li><strong>Ativa</strong> uma leitura do ADC</li>
				<li><strong>Armazena</strong> a leitura numa variável</li>
			</ul>

			<h3>Temporização Flag:</h3>
			<p>A temporização para flag é uma variável utilizada acionar condições e esta é incrementada no Timer0.</p>
			<ul>
				<li><strong>Aciona</strong> a condição: Quando um valor x é resto da divisão inteira (igual a 0)</li>
				<li><strong>Não aciona</strong> a condição: Quando um valor x não é de divisão inteira (diferente de 0)</li>
			</ul>

			<h3>Cálculo do BPM:</h3>
			<p>O cálculo teórico da frequência cardíaca em batimentos por minuto (BPM) é baseado na medida do intervalo entre dois batimentos cardíacos (IBI) determinação do BPM instantâneo. O sistema utiliza um temporizador para medir o tempo e determina o período entre batidas. O sensor SEN0203 capta um sinal analógico que corresponde ao pulso cardíaco. O algoritmo de deteção de picos é suavidade com um filtro média movel e um filtro RC para reduzir o ruido e melhorar os valores do sinal.
			</p>
			<h1>Timer1</h1>
			<p>O Timer1 é um temporizador de 16 bits é usado para gerir um sinal PWM, onde que utiliza um oscilador interno de 8MHz e recorrendo a um modo PWM, prescaler e uma fórmula, reduzimos a frequência de clock para adequar a frequência requerida.</p>
			<ul>
				<li><strong>Componente:</strong> LED Vermelho</li>
				<li><strong>Frequência:</strong> 1Hz</li>
			</ul>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=89" target="_blank">Link pag datasheet</a>
			</p>

			<h1>Timer2</h1>
			<p>O Timer2 é um temporizador de 8 bits é usado para gerir um sinal PWM, onde que utiliza um oscilador interno de 8MHz e recorrendo a um modo PWM, prescaler e uma fórmula, reduzimos a frequência de clock para adequar a frequência requerida.</p>
			<ul>
				<li><strong>Componente:</strong> Buzzer piezoelétrico</li>
				<li><strong>Frequência:</strong> 5KHz</li>
			</ul>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=116" target="_blank">Link pag datasheet</a>
			</p>

			<h1>SPI</h1>
			<p>
				O SPI (Serial Peripheral Interface) é um protocolo de comunicação serial síncrono, que utiliza linhas de dados separadas para transmissão e receção. No projeto, é utilizado para comunicação rápida entre o ATmega328P e dispositivos compatíveis. A comunicação SPI é baseada em um MASTER (ATmega328P) que controla a transferência de dados e um ou mais SLAVE. O MASTER gera o sinal de clock (SCK) e controla a seleção dos SLAVE por meio do pino CS (Chip Select).
			</p>
			<ul>
				<li><strong>Transferência Rápida de Dados:</strong> Ideal para aplicações que exigem alta velocidade de comunicação.</li>
				<li><strong>Sensores e Módulos SPI:</strong> Conexão com dispositivos que utilizam SPI, como displays ou conversores digitais.</li>
			</ul>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=135" target="_blank">Link pag datasheet</a>
			</p>

			<h1>Programação ISP</h1>
			<p>
				A Programação ISP (In-System Programming) é um método utilizado para programar o microcontrolador diretamente no circuito com um programador externo conectado aos pinos apropriados. No projeto, o ATmega328P é programado dessa forma para carregar o firmware necessário, na qual, os comandos e dados são enviados através de SPI (Serial Peripheral Interface).
			</p>
			<ul>
				<li><strong>Gravação de Firmware:</strong> Carrega o código compilado no microcontrolador “arquivo.hex”.</li>
				<li><strong>Configuração de Fuses:</strong> Permite configurar opções avançadas como fonte de clock e temporizadores.</li>
				<li><strong>Atualização no Circuito:</strong> Evita a necessidade de remover o microcontrolador do circuito.</li>
			</ul>
			<p>
				<a href="ATmega328P_Datasheet.pdf#page=17" target="_blank">Link pag datasheet</a>
			</p>

			<h3>Etapas de Programação:</h3>
			<ol>
				<li><strong>Conexão Física:</strong> Conexão ao ATmega328P utilizando os pinos mencionados.</li>
				<li><strong>Compile o código</strong> para gerar o arquivo “arquivo.hex”.</li>
				<li><strong>Upload do Código AVRDUDE:</strong>
					<ul>
						<li>a. Avrdude -c usbasp -p m328p -U flash:w:arquivo.hex</li>
						<li>b. Ou Microchip Studio em “Device Programming” com target STK500.</li>
					</ul>
				</li>
				<li><strong>Verificação da programação e teste o funcionamento.</strong></li>
			</ol>

			<br>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff; border: none; padding: 0cm"><A NAME="Hardware"></A>
			<FONT SIZE=4>Hardware</FONT></P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% align="justify" VALIGN=middle BGCOLOR="#eeeeee">
			<br>
			
			<h1>Circuito do Projeto</h1>
			<p>Para este projeto utilizamos 11 componentes que são imprescindíveis para que o equipamento se comporte como um só. De seguida iremos demonstrar e descrever todos eles e também dar a nossa perspetiva da nossa escolha.</p>

			<h2>Microcontrolador</h2>
			<p>O primeiro componente selecionado para o projeto foi o microcontrolador ATmega328P, reconhecido pela sua versatilidade e eficiência. Após uma pesquisa detalhada no mercado, concluiu-se que este microcontrolador seria a escolha ideal para atender às necessidades do projeto, devido às suas características técnicas e ao histórico positivo de uso em projetos anteriores.</p>

<p>O ATmega328P possui uma arquitetura robusta, incluindo três temporizadores integrados: dois de 8 bits e um de 16 bits, que permitem o controlo preciso de eventos e operações cronometradas. Ele também conta com 23 pinos configuráveis como entradas ou saídas digitais, oferecendo grande flexibilidade para interface com outros dispositivos.</p>

<p>Para comunicação, o ATmega328P suporta os protocolos UART, SPI e I2C, o que facilita a integração com sensores, módulos e outros componentes externos. Além disso, tem disponível 6 canais PWM que estão associados aos pinos físicos do microcontrolador e que são distribuídos entre os seus temporizadores internos como o timer 0 com 8 bits, timer 1 com 16 bits e timer 2 com 8 bits. Cada canal PWM permite gerar um sinal digital com ciclos de trabalho (duty cycle) configuráveis.</p>

<p>Possui também um conversor analógico para digital (ADC) de 10 bits com 6 canais de entrada, numerados de ADC0 a ADC5. Esses canais permitem a conversão de sinais analógicos em valores digitais. O ADC utiliza a referência de tensão interna (V_ref) ou uma tensão externa configurável para realizar a conversão. O multiplexador de entrada permite a seleção dos canais ADC, e as leituras podem ser feitas em modos de operação autônomos ou com interrupções. O ADC do ATmega 328P também oferece recursos como prescaler de clock, ajustes de ganho e configuração de canal único ou múltiplos canais.</p>

<p>Essas características tornam o ATmega328P uma solução compacta, eficiente e altamente adequada para este projeto que exige desempenho confiável e integração com diversos periféricos.</p>

<div class="image-container">
    <img src="atmega328p.png" alt="Microcontrolador" class="img1">
	<a href ="Atmega328p_pinout.png" target="_blank">
	<img src="Atmega328p_pinout.png" alt="Atmega328p_pinout" class="img1" style="width: 700px;" >
	</a>
	
</div>

			<p>
				<a href="ATmega328P_Datasheet.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>

			<h2>Sensor de Frequência Cardíaca SEN0203</h2>
			<p>O sensor de frequência cardíaca SEN0203 utiliza tecnologia ótica para medir as variações no fluxo sanguíneo, possibilitando a monitorização da frequência cardíaca em tempo real com precisão. Para garantir um sinal analógico mais estável antes do processamento, o dispositivo conta com um filtro RC integrado, que suaviza as leituras.</p>
			<p>Durante o desenvolvimento do projeto, também foram testados outros sensores, como o HW-827 e o WPSE340. No entanto, ambos apresentaram uma qualidade inferior para os objetivos pretendidos, resultando em desempenho aquém do esperado. Por isso, optou-se pelo SEN0203, que demonstrou ser a solução mais adequada às necessidades do projeto.</p>
			
			<div class="image-container">
				<img src="SEN0203.jpg" alt="Sensor de Frequência Cardíaca SEN0203" class="img1">
				<a href="Filtro_RC_ADC.jpg" target="_blank">
				<img src="Filtro_RC_ADC.jpg" alt="Gráfico filtro RC" class="img1" style="width: 600;">
			</a>
			</div>
			
			</div>
			<p>
				<a href="SEN0203.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>

			<h2>Display OLED 128 x 64</h2>
			<p>O display OLED 128x64 é um módulo monocromático projetado para exibir informações de forma clara e interativa, ideal para aplicações compactas e de baixo consumo de energia. No contexto deste projeto, ele é usado para apresentar dados importantes, como o batimento cardíaco em tempo real, o valor médio após um minuto, a percentagem de bateria restante, o período de contagem, a mediana dos valores adquiridos, a entrada analógica e o valor convertido pelo ADC. Essa funcionalidade permite ao utilizador monitorizar facilmente as informações críticas do sistema.</p>
			<p>O display utiliza uma interface de comunicação I2C, o que simplifica sua ligação ao microcontrolador. Esse protocolo requer apenas duas linhas para comunicação (SDA e SCL), economizando assim pinos e facilitando a construção do circuito em sistemas compactos. A interface I2C do display é implementada com transístores MOSFET e resistências pull-up, garantindo que as linhas de dados e clock permaneçam em nível lógico alto quando nenhum dispositivo está a transmitir, enquanto o nível lógico baixo é usado durante a transmissão de dados.</p>
			<p>Esse design eficiente permite uma integração perfeita com o microcontrolador ATmega328P, aproveitando seus recursos para controlar o display de maneira modular e confiável, respeitando as especificações do protocolo I2C. Com isso, o display OLED 128x64 se destaca como uma escolha prática e eficaz para fornecer feedback visual ao usuário em tempo real.</p>
			<div class="image-container">
				<img src="oledsh1106.jpg" alt="Display OLED" class="img1">
				<a href ="oledsh1106_circuit.png" target="_blank">
					<img src="oledsh1106_circuit.png" alt="Circuito OLED" class="img1" style="width: 700px;" >
					</a>
			</div>
			
			<p>
				<a href="1.3inch-SH1106-OLED.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>
			
			
			<h2>Módulo Wi-Fi ESP01</h2>
			<p>O módulo Wi-Fi ESP01, baseado no chip ESP8266, é uma solução compacta e eficiente para comunicação sem fios utilizando o protocolo UART. Esse módulo permite a ligação com redes Wi-Fi, possibilitando a transmissão de dados de forma rápida e confiável. No contexto deste projeto, ele é essencial para visualizar o gráfico dos batimentos cardíacos numa plataforma online. </p>
			<p> Através do módulo ESP01, o sistema conecta-se à plataforma ThingSpeak utilizando uma rede Wi-Fi. Após estabelecer a ligação, o módulo institui uma ligação segura com o servidor da API e envia os dados dos batimentos cardíacos de forma contínua. Essa comunicação é realizada com o uso de comandos AT e protocolo HTTP, que garantem a integração eficiente com o servidor.</p>
			<p>O ESP01 é especialmente vantajoso para aplicações IoT devido ao seu baixo consumo de energia, suporte a várias redes Wi-Fi e flexibilidade em comunicação remota. Dessa forma, ele permite a transmissão em tempo real dos dados do projeto, contribuindo para uma monitorização dinâmica e acessível. </p>
			<div class="image-container">
				<img src="modulo_wifi_esp01.png" alt="Módulo Wi-Fi ESP01" class="img1">
				<a href ="ESP01_circuito.png" target="_blank">
					<img src="ESP01_circuito.png" alt="Esquema elétrico ESP01" class="img1" style="width: 700px;" >
					</a>
				
			</div>
			
			<p>
			
				<a href="esp01_AT_instruction.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>

			<h2>Sensor Acelerómetro MPU6050</h2>
			<p>O sensor acelerómetro MPU6050 é uma solução avançada que combina um acelerómetro e um giroscópio de 6 eixos, ideal para medir aceleração linear, movimento e velocidade angular. Ele é capaz de medir acelerações em três eixos (X, Y, Z) e detetar rotações angulares, tornando-o uma escolha versátil para diversas aplicações que envolvem monitorização de movimento e orientação. </p>
			<p> Uma das vantagens do MPU6050 é a comunicação via I2C, que simplifica sua integração com o microcontrolador, economizando pinos e facilitando o desenvolvimento do sistema. Além disso, o sensor possui um processador digital de movimento (DMP) embutido, que realiza o pré-processamento dos dados e filtra ruídos, reduzindo significativamente a carga de trabalho do microcontrolador e melhorando a precisão das medições.</p>
			<p> Inicialmente, utilizou-se o acelerómetro ADXL345 no projeto. No entanto, após uma análise mais aprofundada, decidiu-se optar pelo MPU6050 devido à sua superioridade nos resultados apresentados e à maior flexibilidade que ele oferece em termos de funcionalidades. Essa escolha foi posteriormente validada na prática, confirmando as expectativas e garantindo medições confiáveis e de alta qualidade para o sistema desenvolvido.</p>
			<div class="image-container">
				<img src="accelerometer-mpu6050.jpg" alt="Sensor Acelerómetro MPU" class="img1">
				<a href ="accelerometer-mpu6050_circuit.png" target="_blank">
					<img src="accelerometer-mpu6050_circuit.png" alt="Esquema elétrico MP6050" class="img1" style="width: 700px;" >
					</a>
				
				</div>
			<p>
				<a href="MPU6050.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>

			<h2>Bateria para Alimentação do Sistema</h2>
			<p>Para alimentar o circuito, utilizou-se uma bateria de íon-lítio de 3,7 V e 200 mAh, escolhida por oferecer várias horas de operação contínua, com base nos cálculos de capacidade e no consumo total dos componentes do sistema. Essa bateria foi considerada ideal para o projeto, equilibrando eficiência energética e portabilidade. A percentagem da bateria é exibida no display OLED, permitindo ao utilizador monitorizar facilmente o nível de carga.</p>
			<p>Para garantir o funcionamento adequado dos componentes que operam em 3,3 V, incluímos um regulador de tensão no circuito. Este regulador reduz a tensão da bateria de 3,7 V para 3,3 V, assegurando uma alimentação estável e protegendo os dispositivos sensíveis. Paralelo ao regulador, a bateria é conectada a um divisor de tensão, formado por duas resistências em série, que reduz a tensão a um nível seguro para ser lido pelo ADC do microcontrolador. Isso possibilita uma supervisão precisa do estado da bateria em tempo real.</p>
			<p> Com esse circuito otimizado, a bateria oferece uma autonomia estimada de aproximadamente 3,76 horas, considerando o consumo total do sistema. Essa solução combina eficiência energética com funcionalidades essenciais para controlar o estado da bateria, garantindo confiabilidade e praticidade no uso do dispositivo.</p>
			
			<div class="image-container">
				<img src="bateria-recarregavel-li-po-3-7v-1200mah.jpg" alt="Bateria íon-lítio" class="img1">
				<a href ="circuito_regulador.png" target="_blank">
					<img src="circuito_regulador.png" alt="Circuito regulador bateria" class="img1" style="width: 700px;" >
					</a>
				
			</div>
			
			<p align="center"><b>Eficiência de 90%:</b></p>
			<p class="formula" align="center">
				I<sub>ajustada</sub> = 47,9 ÷ 0,9 ≈ 53,22 mA
			</p>
			<p align="center"><b>Tempo de Operação:</b></p>
			<p class="formula" align="center">
				T = 200 ÷ 53,22 ≈ 3,76 h
			</p>
			<table border="1" align=center>
				<tr align=center>
					<td><b>Componetes</b></td>
					<td><b>Tensão (V)</b></td>
					<td><b>Corrente (mA)</b></td>
					<td><b>Potência (mW)</b></td>
				</tr>
				<tr align=center>
					<td>Atmega328p</td>
					<td>3,3</td>
					<td>~ 6,7</td>
					<td>~ 22,11</td>
				</tr>
				<tr align=center>
					<td>LED RED (R2)</td>
					<td>2</td>
					<td>~ 1,2</td>
					<td>~ 2,4</td>
				</tr>
				<tr align=center>
					<td>LED GREEN (R1)</td>
					<td>2,1</td>
					<td>~ 1</td>
					<td>~ 2,1</td>
				</tr>
				<tr align=center>
					<td>Buzzer (R7)</td>
					<td>3,3</td>
					<td>~ 3</td>
					<td>~ 9,9</td>
				</tr>
				<tr align=center>
					<td>MPU6050</td>
					<td>3,3</td>
					<td>~ 7,1</td>
					<td>~ 23,43</td>
				</tr>
				<tr align=center>
					<td>SEN0203</td>
					<td>3,3</td>
					<td>~ 1,6</td>
					<td>~ 5,28</td>
				</tr>
				<tr align=center>
					<td>OLED</td>
					<td>3,3</td>
					<td>~ 4,7</td>
					<td>~ 15,51</td>
				</tr>
				<tr align=center>
					<td>ESP01</td>
					<td>3,3</td>
					<td>~ 22,6</td>
					<td>~ 74,58</td>
				</tr>
				<tr align=center>
					<td><b>TOTAL:</b></td>
					<td><b></b></td>
					<td><b>~ 47,9</b></td>
					<td><b>~ 158,07</b></td>
				</tr>
			</table>
			<p>
				<a href="battery.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>

			<h2>LED Vermelho e Verde</h2>
			<p>O sistema tem incorporado 2 LED um vermelho e um verde. O led vermelho é usado para piscar a uma frequência fixa de 1 Hz controlado pela saída pwm do microcontrolador. O led verde é mais um feedback para o utilizador pois pisca em sincronia com o batimento cardíaco do utlizador.  </p>
			<p class="center"><img src="led´s.jpg" alt="LEDs" class="img1"></p>
			<p>
				<a href="https://www.make-it.ca/3mm-led-specifications/" target="_blank">Link pag datasheet [4]</a>
			</p>

			<h2>Buzzer para Alertas</h2>
			<p>Achamos por bem incluir um buzzer para completar o sensor de batimentos cardíacos para que seja possível perceber de uma forma mais rápida que o batimento cardíaco do utente alcançou ou ultrapassou os 180 BPM. </p>
			<p class="center"><img src="buzzer-piezo.jpg" alt="Buzzer" class="img1"></p>
			<p>
				<a href="PIEZOELECTRIC.pdf#page=1" target="_blank">Link pag datasheet</a>
			</p>

			<h2>Projeto Completo</h2>
			<p>Nas seguintes figuras, demonstramos a montagem completa do nosso projeto com todos os componentes acima explicados. Futuramente, pretendemos imprimir a placa PCB e utilizá-la no projeto real.</p>
			<div class="image-row">
				<a href ="Projeto_completo_IMG-video.png" target="_blank">
					<img src="Projeto_completo_IMG-video.png" alt="Projeto Completo" class="img1" >
					</a>
				<a href ="circuito.png" target="_blank">
				<img src="circuito.png" alt="Esquema elétrico em kikad" class="img1">
				</a>
				
			</div>

			<h2>Placa PCB</h2>
			<p>O nosso grupo decidiu desenhar a PCB no programa KiCad, mas não proceder à sua fabricação. Esta escolha baseia-se na redução de custos e na flexibilidade para testar e validar o circuito em protoboard, permitindo cumprir os objetivos educacionais do projeto de forma eficiente.</p>
			<div class="image-row">
				<a href ="PCB_FRONT.png" target="_blank">
					<img src="PCB_FRONT.png" alt="Placa PCB frontal" class="img1" >
					</a>
		
				<a href ="PCB_BACK.png" target="_blank">
					<img src="PCB_BACK.png" alt="Placa PCB retaguarda" class="img1" >
					</a>
	
				<a href ="PCB_circuit.png" target="_blank">
					<img src="PCB_circuit.png" alt="Placa PCB 3D" class="img1" >
					</a>
				
			</div>
	
			<br>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff; border: none; padding: 0cm"><A NAME="Software"></A>
			<FONT SIZE=4>Software</FONT></P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% align="justify" VALIGN=middle BGCOLOR="#eeeeee">
			<br>

			<h2>SOFTWARE</h2>
			<P class="image-row">
				<a href ="Fluxograma_Software.png" target="_blank">
				<img src="Fluxograma_Software.png" alt="Fluxograma do Software" class="img2">
				</a>
			</P>
			
			<h2>MAIN</h2>
			<ul>
				<li><b>float battery_percentage():</b> Calcula percentagem de bateria</li>
				<p>
					<a href="battery.pdf#page=3" target="_blank">Link pag datasheet</a>
				</p>
			</ul>

			<h2>MPU6050 (MAIN)</h2>
			<ul>
				<li><b>void MPU6050_init(void):</b> Inicializa o MPU6050/li>
				<li><b>void detect_fall(void):</b> Detecta quedas de g = 1,2</li>

				<h4>Configuracao INIT:</h4>
				<ul>
					<li><strong>MPU6050_ADDR:</strong> 0x68, (1101000b,	Endereço I2C do MPU6050 (7 bits))</li>
					<li><strong>ACCEL_XOUT_H:</strong> 0x3B, (Registo de início para leitura do acelerómetro)</li>
				</ul>
				<p>
					<a href="MPU6050.pdf#page=15" target="_blank">Link pag datasheet</a>
				</p>
			</ul>

			<h2>ADC</h2>
			<ul>
				<li><b>void ADC_init(void):</b> Inicializa o módulo ADC</li>
				<li><b>uint16_t ADC_read(uint8_t canal):</b> Lê o valor do ADC de um canal especificado</li>

				<h4>Configuração INIT:</h4>
				<ul>
					<li><strong>ADCSRA:</strong> ADEN, (Habilita o ADC)</li>
					<li><strong>ADCSRA:</strong> ADPS2 & ADPS1, (prescaler 64)</li>
				</ul>
				<p>
					<a href="ATmega328P_Datasheet.pdf#page=205" target="_blank">Link pag datasheet</a>
				</p>
			</ul>

			<h2>I2C</h2>
			<ul>
				<li><b>void I2C_init(void):</b> Inicializa o módulo I2C (TWI)</li>
				<li><b>void I2C_start(void):</b> Envia condição de <i>start</i> no barramento I2C</li>
				<li><b>void I2C_stop(void):</b> Envia condição de <i>stop</i> no barramento I2C</li>
				<li><b>void I2C_write(uint8_t data):</b> Escreve um byte de dados no barramento I2C</li>
				<li><b>uint8_t I2C_read_ack(void):</b> Lê um byte do barramento I2C e envia ACK</li>
				<li><b>uint8_t I2C_read_nack(void):</b> Lê um byte do barramento I2C e envia NACK</li>

				<h4>Configuracao INIT:</h4>
				<ul>
					<li><strong>TWSR:</strong> 0x00, (Inicializa o barramento I2C/TWI)</li>
					<li><strong>TWBR:</strong> (((8MHz / 400kHz) - 16) / 2), (Configura o registador TWBR para obter SCL = 400kHz)</li>
					<li><strong>TWCR:</strong> TWEN, (Habilita o módulo TWI/I2C)</li>
				</ul>
				<p>
					<a href="ATmega328P_Datasheet.pdf#page=173" target="_blank">Link pag datasheet</a>
				</p>
			</ul>

			<h2>I/O</h2>
			<ul>
				<li><b>void IO_init(void):</b> Inicializa o I/O</li>
				<li><b>void LED_ON(void):</b> Altera a porta do LED para "0"</li>
				<li><b>void LED_OFF(void):</b> Altera a porta do LED para "1"</li>

				<h4>Configuracao INIT:</h4>
				<ul>
					<li><strong>PB1:</strong> PWM1_DDR |= (1 << PWM1_PIN), (OUTPUT)</li>
					<li><strong>PD3:</strong> PWM2_DDR |= (1 << PWM2_PIN), (OUTPUT)</li>
					<li><strong>PB0:</strong> LED_PULSE_DDR |= (1 << LED_PULSE_PIN), (OUTPUT)</li>
				</ul>
				<p>
					<a href="ATmega328P_Datasheet.pdf#page=58" target="_blank">Link pag datasheet</a>
				</p>
			</ul>

			<h2>OLED</h2>
			<ul>
				<li><b>void oled_command(uint8_t cmd):</b> Função para enviar um comando ao OLED</li>
				<li><b>void oled_data(uint8_t data):</b> Função para enviar um dado ao OLED</li>
				<li><b>void oled_clear(void):</b> Limpa a tela do OLED</li>
				<li><b>void oled_init(void):</b> Inicializa o OLED</li>
				<li><b>void oled_set_cursor(uint8_t row, uint8_t col):</b> Define o cursor (linha e coluna)</li>
				<li><b>const uint8_t font5x7[5]:</b> Fonte de 5x7 pixels (declarada como constante em PROGMEM)</li>
				<li><b>void oled_print(char* str):</b> Função para enviar string</li>
			
				<h4>Configuração INIT:</h4>
				<ul>
					<li><strong>OLED_ADDRESS:</strong> 0x3C, (0111100b, Endereço padrão do OLED)</li>
				</ul>
				
				<p>
					<a href="1.3inch-SH1106-OLED.pdf#page=17" target="_blank">Link pag datasheet</a>
				</p>
			</ul>

			<h2>UART</h2>
			<ul>
				<li><b>void UART_init(void):</b> Inicializa o modulo UART</li>
				<li><b>void UART_transmit(char data):</b> Transmite um unico caractere pela UART</li>
				<li><b>unsigned char UART_receive(void):</b> Recebe um unico caractere pela UART</li>
				<li><b>void UART_send_string(const char *str):</b> Envia uma string pela UART</li>

				<h4>Configuração INIT:</h4>
				<ul>
					
					<li><strong>BAUD_PRESCALE:</strong> ((8MHz / (8UL * BAUD)) - 1), (prescaler)</li>
					<li><strong>UBRR0H:</strong> BAUD_PRESCALE >> 8, (4 bits mais significativos)</li>
					<li><strong>UBRR0L:</strong> BAUD_PRESCALE, (8 bits menos significativos)</li>
					<li><strong>UCSR0A:</strong> U2X0, (Double the USART Transmission Speed)</li>
					<li><strong>UCSR0B:</strong> TXEN0, (Transmitter Enable)</li>
					<li><strong>UCSR0C:</strong> UCSZ01 & UCSZ00, (8bits data) </li>
					<li><strong>BAUD:</strong> 76800</li>

					 
				</ul>
				<p>
					<a href="ATmega328P_Datasheet.pdf#page=143" target="_blank">Link pag datasheet</a>
				</p>
			</ul>
			

			<h2>TIMER0</h2>
			<ul>
				<li><b>uint16_t filtro_media_movel(uint16_t novo_valor):</b> Suaviza ruidos, com a média dos ultimos N valores</li>
				<li><b>void calculate_heart_beat(int adc_value):  :</b> Função que deteta batimento cardiaco e determina o BPM</li>

				<h4>Configuração INIT:</h4>
				<ul>
					<li><strong>TCCR0A:</strong> WGM01, (Modo CTC)</li>
					<li><strong>TCCR0B:</strong> CS01 & CS00, (Prescaler 64)</li>
					<li><strong>OCR0A:</strong> 124, (1KHz = 8MHz / (2 * 256 * (1 + OCR0A)))</li>
					<li><strong>TIMSK0:</strong> OCIE0A (Habilita interrupção de comparação)</li>
					<li><strong>Frequencia:</strong> 1KHz (T = 1ms)</li>
				</ul>
				<p>
					<a href="ATmega328P_Datasheet.pdf#page=74" target="_blank">Link pag datasheet</a>
				</p>
			</ul>

			<h2>TIMER1</h2>
			<ul>
				<li><b>void TIMER1_init(void):</b> Inicialização do PWM no Timer1 (1Hz)</li>

				<h4>Configuracao INIT:</h4>
				<ul>
					<li><strong>TCCR1A:</strong> COM1A1, (Saída no OC1A não invertido)</li>
					<li><strong>TCCR1B:</strong> WGM13, (Modo Phase and Frequency Correct)</li>
					<li><strong>TCCR1B:</strong> CS12, (prescaler 256)</li>
					<li><strong>ICR1:</strong> 15625, (1Hz = 8MHz / (2 * 256 * ICR1))</li>
					<li><strong>Frequencia:</strong> 1Hz</li>
				</ul>
				<p>
					<a href="ATmega328P_Datasheet.pdf#page=89" target="_blank">Link pag datasheet</a>
				</p>
			</ul>
			

			<h2>TIMER2</h2>
			<ul>
				<li><b>void TIMER2_init(void):</b> Inicialização do PWM no Timer2 (5KHz)</li>

				<h4>Configuração INIT:</h4>
				<ul>
					<li><strong>TCCR1A:</strong> COM2B1, (Saída no OC2B não invertido)</li>
					<li><strong>TCCR1A:</strong> WGM21 & WGM20, (Modo Fast PWM)</li>
					<li><strong>TCCR1B:</strong> CS21, (prescaler 8)</li>
					<li><strong>OCR2B:</strong> 199, (5KHz = 8MHz / (8 * OCR2B))</li>
					<li><strong>Frequencia:</strong> 5KHz</li>
				</ul>
				<p>
					<a href="ATmega328P_Datasheet.pdf#page=116" target="_blank">Link pag datasheet</a>
				</p>
			</ul>
			

			<br>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff; border: none; padding: 0cm"><A NAME="Resultados"></A>
			<FONT SIZE=4>Resultados</FONT></P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% align="justify" VALIGN=middle BGCOLOR="#eeeeee">
			<br>

			<h1>Resultados</h1>
    <p>Para obter os resultados foram realizados diversos testes com base no funcionamento do sistema com um ponto de vista consumidor.</p>

    <h2>BPM</h2>
    <p>No protótipo do projeto foi implementado nas breadboards com redução máxima do comprimento ou sobreposição dos fios e utilização de filtros para minimizar ruídos (white noise), isto porque o projeto requer uma determinação sensível e precisão de um sinal ADC de variações pequenas, o sinal foi convertido para digital e processado via código por um filtro média movel para suavizar e maximizar a qualidade do sinal, e assim com temporizadores e condições sendo possível obter os batimentos por minuto (BPM) com um erro aproximado de +/-1BPM dependendo do local de medição cardíaca.</p>

    <h2> Acelerómetro</h2>
    <p>Relativamente ao acelerómetro a determinação dos dados de 16bits é necessário captar os níveis HIGH e LOW da Receção I2C de cada vetor (X,Y,Z) e organizar numa variável com objetivo de converter para unidades de gravidade (g). Após conversão a variação do movimento é um somatório vetorial no qual chamamos de “vetor resultante”. Para finalizar realiza-se uma condição com um valor gravítico estabelecido (ACCEL_CHANGE_THRESHOLD) para indicação de sensibilidade da deteção de quedas ou movimentos bruscos, neste caso g1,2.</p>
    
	<h2> OLED</h2>
    <p>A apresentação dos dados no OLED é com base no I2C, para tal foi implementado no código a tabela ASCII para reconhecimento e transmissão binária, para que os textos sejam convertidos com as respetivas variações das variáveis juntamente com a linha de exposição do texto e limpeza do espaço em “branco”.</p>

    <h2>WIFI</h2>
    <p>O envio dos dados para a cloud foi usado um ESP01 com firmware AT e a plataforma ThingSpeak, para suceder a transmissão, o Firmware AT só querer de uma configuração de comandos básicos via UART, tais como configurar a baud rate 76800 de 8 bits e 1 bit stop, protocolo TCP/IP, configuração da rede WiFi (nome/password) para comunicação cloud. O envio é feito em quatro passos num tempo estabelecido de 7,5s de forma a garantir a comunicação e finalizar transmissão dos dados em 30s, estes dados serão apresentados no ThingSpeak de forma gráfica.</p>

    <h2>Bateria</h2>
    <p>A bateria é um componente essencial para ilustração e portabilidade do projeto, a tensão de 3,7v passa por um processo de redução com um regulador (AP2114) de 3,3V que suporta 1A, e assim, com um simples divisor de tensão separado e paralelo ao regulador é possível a análise da percentagem no display de tensão 3,3V de forma a ser exequível a verificar a sua variação. Foi retirado medições de corrente de cada componente para determinar a duração da bateria, e com base nos resultados o uso de componentes “low power” é uma opção viável para maior prolongação da bateria.</p>
    
	<h1>Discussão</h1>
    <h2>Pontos positivos:</h2>
    <ul>
        <li>Análise de algoritmo para determinar do intervalo de batimento cardíaco;</li>
        <li>Comunicação I2C para simplificação esquemática e visualização dos dados;</li>
        <li>Implementação do ThingSpeak para monitorização do BPM instantâneo;</li>
        <li>Circuito operacional a 3,3V com regulador de tensão e bateria;</li>
        <li>Simplificação do circuito protótipo;</li>
        <li>Criação e projeção de circuito compactado e de pequenas dimensões (PCB).</li>
    </ul>

    <h2>Desafios:</h2>
    <ul>
        <li>Condicionamento e processamento de sinais pequenos e a presença de ruído;</li>
        <li>Sensores de gama básica implica existência de ruido em movimento;</li>
        <li>Diversidade de resolução física e código nem sempre favorável;</li>
        <li>Consumos energéticos;</li>
		<li>Projeção da placa PCB </li>
    </ul>

    <h2>Sugestões de melhorias futuras:</h2>
    <ul>
        <li>Redução de consumo energético via código com sleep mode, watchdog, etc;</li>
        <li>Redução de consumo energético no circuito com o uso de componentes low power;</li>
        <li>Impressão da placa PCB;</li>
        <li>Implementação da PCB e sensores no modelo 3D (similar a um relógio);</li>
        <li>Uso de sensores de melhor qualidade;</li>
        <li>Melhoramento no processamento dos sinais.</li>
    </ul>
			
			<br>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff; border: none; padding: 0cm"><A NAME="Conclus&otilde;es"></A>
			<FONT SIZE=4>Conclus&otilde;es</FONT></P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% align="justify" VALIGN=middle BGCOLOR="#eeeeee">
			<br>
			<h1>Conclusão</h1>
			<p>
				Este projeto demonstra uma abordagem metódica e abrangente no desenvolvimento de um sistema de monitorização com funcionalidades específicas,  tais como, a monitorização de batimentos cardíacos por minuto, deteção de quedas e comunicação com plataformas de dados. 
				A escolha criteriosa de componentes, protocolos de comunicação e software reflete uma compreensão sólida dos requisitos técnicos e práticos de um dispositivo atual.
			</p>
			<p>
				Pode-se considerar como pontos positivos a utilização de múltiplos protocolos de comunicação (I2C, UART, SPI), aliada a uma arquitetura modular, assegura flexibilidade e eficiência no desenvolvimento. 
				A inclusão de sensores, como o acelerómetro MPU6050 e o sensor de frequência cardíaca SEN0203, proporciona medições com mais precisão, enquanto a interface OLED facilita a interação com o utilizador. A integração do módulo ESP01 e da plataforma ThingSpeak amplia as funcionalidades do dispositivo, permitindo monitorização remota e análise gráfica dos dados recolhidos. 
				O cálculo detalhado do consumo energético e a escolha de uma bateria apropriada demonstram a preocupação em garantir autonomia operacional.
			</p>
			<p>
				Como desafios e limitações a necessidade de filtros ,como o filtro RC, para suavizar os dados comprova as dificuldades no processamento de sinais analógicos sensíveis. O elevado consumo de componentes como o ESP01,display OLED e o acelarómetro limita a duração da bateria. 
				Sensores de gama básica apresentam maior sensibilidade a interferências e ruídos, afetando a precisão das medições.
			</p>
			<p>
				Para melhorias futuras a implementação de modos de economia de energia no microcontrolador e utilização de componentes de baixo consumo para aumentar a autonomia. A produção de uma placa de circuito impresso aumentaria a robustez e portabilidade do dispositivo. 
				A construção de um protótipo mais compacto, similar a um relógio, melhoraria a ergonomia e a atratividade do produto. A substituição de sensores de gama básica por opções mais precisas e menos suscetíveis a ruídos pode melhorar significativamente o desempenho. 
				Aperfeiçoamento do algoritmo de processamento de sinais e deteção de quedas para maior confiabilidade e precisão.
			</p>
			<br>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff; border: none; padding: 0cm"><A NAME="Refer&ecirc;ncias"></A>
			<FONT SIZE=4>Refer&ecirc;ncias</FONT></P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm"><A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=12 WIDTH=100% VALIGN=TOP BGCOLOR="#eeeeee">
			<br>
			<p>
				<a HREF="https://coospo.com/products/hw9-armband-heart-rate-monitor">
					[1] COOSPO REALZONE HW9 Armband Heart Rate Monitor
				</a>
			</p>
			<p>
				<a HREF="https://www.cycplus.com/products/cycplus-h1-heart-rate-monitor-band?srsltid=AfmBOooOIMAOGTqRJ4Sc-ilbHdxBalT8VNue7awPvi0ozhFOnYFaVdcN">
					[2] Cycplus H1 Heart Rate Monitor Band 
				</a>
			</p>
			<p>
				<a HREF="https://mindfield-esense.com/esense-pulse-hrv-en/index.php">
					[3] Mindfield eSense Pulse
				</a>
			</p>
			<p>
				<a HREF="https://www.make-it.ca/3mm-led-specifications/">
					[4] LED's
				</a>
			</p>
			<p>(By ALLDATASHEETCOM, 2017)</p>
			<p>https://www.pordata.pt/pt/estatisticas/populacao/esperanca-de-vida-e-obitos/esperanca-de-vida-nascenca-por-sexo</p>
			<p>https://www.who.int/data/gho/data/themes/mortality-and-global-health-estimates/ghe-life-expectancy-and-healthy-life-expectancy</p>	
			<p>(1.3inch-SH1106-OLED, n.d.)</p>
			<p>(Preliminary Datasheet 1A LOW NOISE CMOS LDO REGULATOR WITH ENABLE AP2114 General Description, 2010)</p>
			<p>ATmega328P 8-Bit AVR Microcontroller with 32K Bytes In-System Programmable Flash DATASHEET, n.d.</p>
			<p>1.3 Inch OLED I2C 128×64 3-5V - UNIVERSAL-SOLDER Electronics Ltd, n.d.</p>
			<p>1.3inch-SH1106-OLED, n.d.</p>
			<p>Bateria Recarregável Li-Po 3.7V 1200mAh 40x30x9mm PIJUICE, n.d.</p>
			<p>China Low Price ATMEGA328P-PU ATMEGA328P DIP28 Microcontroller MCU Chip - Quotation - GNS COMPONENTS, n.d.</p>
			<p>DFRobot SEN0203 Gravity: Heart Rate Monitor Sensor for Arduino | Rapid Electronics, n.d.</p>
			<p>Módulo Wifi ESP8266 ESP-01, n.d.</p>
			<p>Piezo Elements Buzzer 35mm :: Micro JPM, n.d.</p>
			<p>Sensor de Frequência Cardíaca Cycplus H1 | Deporvillage, n.d.</p>
			<p>Módulo MPU6050 Com o Arduino • AranaCorp, n.d.</p>
			<p>By ALLDATASHEETCOM, 2012, 2017</p>
			

			<br>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD COLSPAN=11 WIDTH=94%>
			<P ALIGN=LEFT STYLE="background: #00d9ff"><BR>
			</P>
		</TD>
		<TD WIDTH=6%>
			<P ALIGN=CENTER STYLE="background: #00ccff; border: none; padding: 0cm">
			<A HREF="#In&iacute;cio"><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Thorndale, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">In&iacute;cio</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		</TD>
	</TR>
</TABLE>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=CENTER><BR><BR>
</P>
</BODY>
</HTML>

